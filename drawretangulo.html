<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiauAPI Rectangle System</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 1920px;
            height: 1080px;
            overflow: hidden;
            background: transparent;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        #app {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .rectangle {
            position: absolute;
            transition: all 0.3s ease;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .rectangle-inner {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div id="app">
        <div 
            v-for="rect in rectangles" 
            :key="rect.id"
            class="rectangle"
            :style="getRectangleStyle(rect)"
        >
            <div class="rectangle-inner">
                {{ rect.showLabel ? `Rectangle ${rect.id}` : '' }}
            </div>
        </div>
    </div>

    <script>
        // Configurações padrão do sistema
        const CONFIG = {
            defaultWidth: 860,
            defaultHeight: 660,
            defaultColor: { r: 41, g: 128, b: 185 },
            defaultAlpha: 200,
            animationDuration: 300,
            showLabels: false
        };

        new Vue({
            el: '#app',
            data: {
                rectangles: [],
                nextId: 1
            },
            mounted() {
                // Registra o hook global para comunicação com Lua
                window.MiauAPI = {
                    Rectangle: this.createRectangle,
                    UpdateRectangle: this.updateRectangle,
                    RemoveRectangle: this.removeRectangle,
                    ClearAll: this.clearAll,
                    SetConfig: this.setConfig
                };

                // Listener para mensagens do NUI (FiveM)
                window.addEventListener('message', (event) => {
                    const data = event.data;
                    
                    if (data.action === 'createRectangle') {
                        this.createRectangle(
                            data.x, data.y, data.w, data.h,
                            data.r, data.g, data.b, data.a
                        );
                    } else if (data.action === 'updateRectangle') {
                        this.updateRectangle(data.id, data.x, data.y, data.w, data.h, data.r, data.g, data.b, data.a);
                    } else if (data.action === 'removeRectangle') {
                        this.removeRectangle(data.id);
                    } else if (data.action === 'clearAll') {
                        this.clearAll();
                    }
                });

                console.log('MiauAPI Rectangle System Initialized');
            },
            methods: {
                createRectangle(x, y, w, h, r, g, b, a) {
                    const rect = {
                        id: this.nextId++,
                        x: x || 0,
                        y: y || 0,
                        w: w || CONFIG.defaultWidth,
                        h: h || CONFIG.defaultHeight,
                        r: r !== undefined ? r : CONFIG.defaultColor.r,
                        g: g !== undefined ? g : CONFIG.defaultColor.g,
                        b: b !== undefined ? b : CONFIG.defaultColor.b,
                        a: a !== undefined ? a : CONFIG.defaultAlpha,
                        showLabel: CONFIG.showLabels
                    };

                    this.rectangles.push(rect);
                    return rect.id;
                },

                updateRectangle(id, x, y, w, h, r, g, b, a) {
                    const rect = this.rectangles.find(r => r.id === id);
                    if (rect) {
                        if (x !== undefined) rect.x = x;
                        if (y !== undefined) rect.y = y;
                        if (w !== undefined) rect.w = w;
                        if (h !== undefined) rect.h = h;
                        if (r !== undefined) rect.r = r;
                        if (g !== undefined) rect.g = g;
                        if (b !== undefined) rect.b = b;
                        if (a !== undefined) rect.a = a;
                    }
                },

                removeRectangle(id) {
                    const index = this.rectangles.findIndex(r => r.id === id);
                    if (index !== -1) {
                        this.rectangles.splice(index, 1);
                    }
                },

                clearAll() {
                    this.rectangles = [];
                    this.nextId = 1;
                },

                setConfig(options) {
                    if (options.defaultWidth) CONFIG.defaultWidth = options.defaultWidth;
                    if (options.defaultHeight) CONFIG.defaultHeight = options.defaultHeight;
                    if (options.defaultColor) CONFIG.defaultColor = options.defaultColor;
                    if (options.defaultAlpha !== undefined) CONFIG.defaultAlpha = options.defaultAlpha;
                    if (options.showLabels !== undefined) CONFIG.showLabels = options.showLabels;
                },

                getRectangleStyle(rect) {
                    return {
                        left: rect.x + 'px',
                        top: rect.y + 'px',
                        width: rect.w + 'px',
                        height: rect.h + 'px',
                        backgroundColor: `rgba(${rect.r}, ${rect.g}, ${rect.b}, ${rect.a / 255})`
                    };
                }
            }
        });
    </script>
</body>
</html>
